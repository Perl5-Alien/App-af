#!/usr/bin/perl

use strict;
use warnings;
use 5.014;
use App::af;

# PODNAME: af
# ABSTRACT: Command line tool for alienfile
# VERSION

=head1 SYNOPSIS

 af install Alien::foo

=head1 DESCRIPTION

The C<af> command is a command line interface to L<alienfile> and
L<Alien::Build>.

=head3 options

These options are available for all subcommands.

=head4 --help

Print the help for either C<af> as a whole, or the specific subcommand.

=head4 --version

Print the version of C<af> and exit.

=head1 SUBCOMMANDS

=cut

package App::af::download {
  use Moose;
  with 'App::af';

=head2 download

=head3 Usage

 af download
   [
     ( -f | --file )  alienfile | 
     ( -c | --class ) class
   ]
   [ ( -l | --local ) directory

=head3 description

Download the external resource using the usual L<alienfile> logic.  File
will be deposited in the directory indicated by the C<--local> (or C<-l>)
option, or the current working directory if not specified.

=head3 options

=head4 -f | --file

The L<alienfile>.  If neither this option, nor C<-c> is specified, then 
C<alienfile> in the current directory will be assumed.

=head4 -c | --class

Get the L<alienfile> from the already installed Alien module.

=head4 -l | --local

The location to store the downloaded resource.  The current directory
if not specified.

=cut

  sub main
  {
  }

  __PACKAGE__->meta->make_immutable;
}

# options that always work:
# --help
# --version

# download
#   -f | --file alienfile
#   -c | --class (Alien::)?foo
#   -l | --local directory

## Downloads the tarball, directory to
## local directory

# install
#   --prefix
#   --stage
#   -f | --file alienfile
#   -c | --class (Alien::)?foo

## Installs or reinstalls the Alien
## for "-c" mode, --prefix is the distdir
## "--stage" is ~/.alienbuild/af/tmp/XXXXXX by default

package App::test::install{
  use Moose;
  with 'App::af';
  sub main {}
  __PACKAGE__->meta->make_immutable;
}

# test
#   --prefix
#   --stage
#   -f | --file alienfile
#   -c | --class (Alien::)?foo
#   --before
#   --after    # default
#   -p | --phase ( probe | download | extract | patch | build | gather )

## --prefix is ~/.alienbuild/af/tmp/XXXXX by default
## --stage  is ~/.alienbuild/af/tmp/XXXXX by default

package App::af::test {
  use Moose;
  with 'App::af';
  sub main {}
  __PACKAGE__->meta->make_immutable;
}

# requires
#   -f | --file alienfile
#   -c | --class (Alien::)?foo
#   -p | --phase ( configure | any | share | system )

## prints in YAML format either all requirements, or the reqs
## for the particular phase

package App::af::requires {
  use Moose;
  with 'App::af';
  sub main {}
  __PACKAGE__->meta->make_immutable;
}

# missing
#   -f | --file alienfile
#   -c | --class (Alien::)?foo
#   -p | --phase ( configure | any | share | system )

## prints list of modules not apparently already installed.
## Without phase, will execute probe to determine which phase
## to do.

package App::af::missing {
  use Moose;
  with 'App::af';
  sub main {}
  __PACKAGE__->meta->make_immutable;
}

# prop
#   -c | --class (Alien::)?foo
#   --static
#   --cflags
#   --libs
#   --modversion
#   --bin-dir

## prints the runtime properties of the already installed Alien

package App::af::prop {
  use Moose;
  with 'App::af';
  sub main {}
  __PACKAGE__->meta->make_immutable;
}

# clean

## removes all temp files

package App::af::clean {
  use Moose;
  with 'App::af';
  sub main {}
  __PACKAGE__->meta->make_immutable;
}

my $app = App::af->compute_class->new(@ARGV);
exit($app->main // 0);
